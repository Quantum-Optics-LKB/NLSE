
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../basic_usage/">
      
      
        <link rel="next" href="../contributing/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.25">
    
    
      
        <title>Structure and Inheritance - NLSE Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.6543a935.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#the-nlse-class" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="NLSE Documentation" class="md-header__button md-logo" aria-label="NLSE Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            NLSE Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Structure and Inheritance
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="NLSE Documentation" class="md-nav__button md-logo" aria-label="NLSE Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    NLSE Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Getting started
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Getting started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../basic_usage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Basic Usage
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Structure and Inheritance
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Structure and Inheritance
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#the-nlse-class" class="md-nav__link">
    <span class="md-ellipsis">
      The NLSE class
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The NLSE class">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initialization" class="md-nav__link">
    <span class="md-ellipsis">
      Initialization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#broadcasting" class="md-nav__link">
    <span class="md-ellipsis">
      Broadcasting
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#numerical-precision" class="md-nav__link">
    <span class="md-ellipsis">
      Numerical precision
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#callbacks" class="md-nav__link">
    <span class="md-ellipsis">
      Callbacks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#propagation" class="md-nav__link">
    <span class="md-ellipsis">
      Propagation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inheritance" class="md-nav__link">
    <span class="md-ellipsis">
      Inheritance
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-nlse_1d-class" class="md-nav__link">
    <span class="md-ellipsis">
      The NLSE_1d class
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-nlse_3d-class" class="md-nav__link">
    <span class="md-ellipsis">
      The NLSE_3d class
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-cnlse-class" class="md-nav__link">
    <span class="md-ellipsis">
      The CNLSE class
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-cnlse_1d-class" class="md-nav__link">
    <span class="md-ellipsis">
      The CNLSE_1d class
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-gpe-class" class="md-nav__link">
    <span class="md-ellipsis">
      The GPE class
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../contributing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tutorial
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Tutorial
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../physics_problem/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    What is the Physics problem ?
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../nlse_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NLSE for the gifted amateur
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    How to
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            How to
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../how_to/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to ?
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NLSE
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cnlse/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Coupled NLSE
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../kernels/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kernels
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#the-nlse-class" class="md-nav__link">
    <span class="md-ellipsis">
      The NLSE class
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The NLSE class">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initialization" class="md-nav__link">
    <span class="md-ellipsis">
      Initialization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#broadcasting" class="md-nav__link">
    <span class="md-ellipsis">
      Broadcasting
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#numerical-precision" class="md-nav__link">
    <span class="md-ellipsis">
      Numerical precision
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#callbacks" class="md-nav__link">
    <span class="md-ellipsis">
      Callbacks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#propagation" class="md-nav__link">
    <span class="md-ellipsis">
      Propagation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inheritance" class="md-nav__link">
    <span class="md-ellipsis">
      Inheritance
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-nlse_1d-class" class="md-nav__link">
    <span class="md-ellipsis">
      The NLSE_1d class
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-nlse_3d-class" class="md-nav__link">
    <span class="md-ellipsis">
      The NLSE_3d class
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-cnlse-class" class="md-nav__link">
    <span class="md-ellipsis">
      The CNLSE class
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-cnlse_1d-class" class="md-nav__link">
    <span class="md-ellipsis">
      The CNLSE_1d class
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-gpe-class" class="md-nav__link">
    <span class="md-ellipsis">
      The GPE class
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>Structure and Inheritance</h1>

<h2 id="the-nlse-class">The <code>NLSE</code> class</h2>
<p>The <code>NLSE</code> class aims at providing a minimal yet functional toolbox to solve non-linear Schrödinger type equation in optics / atomic physics settings such as the propagation of light in a Kerr medium or solving the Gross Pitaevskii equation for the evolution of cold gases.</p>
<p>The propagation equation is:</p>
<div class="arithmatex">\[
i\partial_{z}E = -\frac{1}{2k_0}\nabla_{\perp}^2 E +
-\frac{k_0}{2}\delta n(r) E - n_2 \frac{k_0}{2n}c\epsilon_0|E|^2E
\]</div>
<h3 id="initialization">Initialization</h3>
<p>The physical parameters listed above are defined at the instantiation of the <code>NLSE</code> class (<code>__init__</code> function).
The backend (GPU or CPU) is tested when the library is imported, but you can then dynamically switch it when instantiating a <code>NLSE</code> class by setting the <code>self.backend</code> attribute to <code>"GPU"</code> or <code>"CPU"</code>.</p>
<h3 id="broadcasting">Broadcasting</h3>
<p>Since <code>numpy</code> / <code>cupy</code> allow for natural broadcasting of arrays of compatible size, one can leverage this in order to run parallel realizations. For instance, if we wish to propagate various initial state with the same physical parameters,
we simply have to initialize a <em>tensor</em> of fields of dimensions <code>(N_real, Ny, Nx)</code> where <code>N_real</code> is the number of initial states we wish to propagate.</p>
<p>Similarly, one can broadcast over the physical parameters by setting some parameters to be tensors as well. If we wish for instance to study the effect of the variation of <span class="arithmatex">\(n_2\)</span>, one can set the <code>n2</code> attribute to be a <code>(N_real, 1, 1)</code> tensor.
The field should then be initialized to a <code>(N_real, Ny, Nx)</code> tensor of identical fields and each slice over the first dimension will represent the same field propagated with different parameters.
Finally, one can combine broadcasting over several parameters at the same time: if we wish to do a grid search over <span class="arithmatex">\(n_2\)</span> and <span class="arithmatex">\(\alpha\)</span>, one can instantiate <code>n2</code> to be a <code>(N_n2, 1, 1, 1)</code> array, <code>alpha</code> to be a <code>(1, N_alpha, 1, 1)</code> and the field
a <code>(N_n2, N_alpha, Ny, Nx)</code> array.</p>
<p>The take-home message is that the array shape should be compliant with <code>numpy</code> <a href="https://numpy.org/doc/stable/user/basics.broadcasting.html">broadcasting rules</a>.</p>
<p><strong>WARNING : For now it is only available on the GPU backend !</strong></p>
<h3 id="numerical-precision">Numerical precision</h3>
<p>In order to reach the best performance, the numerical precision is hardcoded as a constant variable at the top of <code>nlse.py</code>.
When importing the solvers like <code>NLSE</code>, the data types of the input arrays must match the data type given as input of <code>out_field</code>.</p>
<h3 id="callbacks">Callbacks</h3>
<p>The <code>out_field</code> functions support callbacks with the following signature <code>callback(self, A, z, i)</code> where <code>self</code> is the class instance, <code>A</code> is the field, <code>z</code> is the current position and <code>i</code> the main loop index.
For example if you want to print the number of steps every 100 steps, this is the callback you could write :</p>
<pre><code class="language-python">def callback(nlse, A, z, i):
    n = int(z/nlse.delta_z)
    if n % 100 == 0:
        print(n)
</code></pre>
<p>Notice that since the class instance is passed to the callback, you have access to all of the classes attributes.
Be mindful however that since the callback is running in the main solver loop, this function should not be called too often in order to not slow down the execution too much.</p>
<h3 id="propagation">Propagation</h3>
<p>The <code>out_field</code> method is the main function of the code that propagates the field for an arbitrary distance from an initial state <code>E_in</code> from z=0 (assumed to be the begining of the non linear medium) up to a specified distance z. This function simply works by iterating the spectral solver scheme i.e :</p>
<ul>
<li>(If precision is <code>'double'</code> apply real space terms)</li>
<li>Fourier transforming the field</li>
<li>Applying the laplacian operator (multiplication by a constant matrix)</li>
<li>Inverse Fourier transforming the field</li>
<li>Applying all real space terms (potential, losses and interactions)</li>
</ul>
<p>The <code>precision</code> argument allows to switch between applicating the nonlinear terms in a single multiplication (<code>"single"</code>), or applying a "half" nonlinear term before and after computing the effect of losses, potential and interactions (<code>"double"</code>). The numerical error is <span class="arithmatex">\(\mathcal{O}(\delta z)\)</span> in the first case and <span class="arithmatex">\(\mathcal{O}(\delta z^3)\)</span> in the second case at the expense of two additional FFT's and another matrix multiplication (essentially doubling the runtime).\
The propagation step <span class="arithmatex">\(\delta z\)</span> is chosen to be the minimum between <code>1e-5</code> the Rayleigh length of the beam or <code>2.5e-2</code> <span class="arithmatex">\(z_{NL}=\frac{1}{k_0 n_2 I}\)</span>, but this can be hand tuned to reach desired speed or precision by setting the <code>delta_z</code> attribute.</p>
<h2 id="inheritance">Inheritance</h2>
<p>In order to minimize duplication, all classes inherit from the main <code>NLSE</code> class according to the following graph:
<img alt="inheritance" src="img/inheritance_graph.png" /></p>
<h2 id="the-nlse_1d-class">The <code>NLSE_1d</code> class</h2>
<p><code>NLSE_1d</code> is a 1D specialization of <code>NLSE</code> for performance. 
It supports all of the features of the main <code>NLSE</code> class.</p>
<p>The propagation equation is:</p>
<div class="arithmatex">\[
i\partial_{z}E = -\frac{1}{2k_0}\partial^2_x E +
-\frac{k_0}{2}\delta n(r) E - n_2 \frac{k_0}{2n}c\epsilon_0|E|^2E
\]</div>
<h2 id="the-nlse_3d-class">The <code>NLSE_3d</code> class</h2>
<p><code>NLSE_3d</code> solves the full paraxial propagation equation.</p>
<p><strong>WARNING:</strong> Since this solves a 3D+1 equation, this is computationally very intensive ! The space complexity scales as <span class="arithmatex">\(N^3\)</span> if <span class="arithmatex">\(N\)</span> is the field array size.</p>
<p>The propagation equation is:</p>
<div class="arithmatex">\[
i\partial_{z}E = -\frac{1}{2k_0}\nabla_{\perp}^2 E +
\frac{D_0}{2}\partial^2_t E
-\frac{k_0}{2}\delta n(r) E - n_2 \frac{k_0}{2n}c\epsilon_0|E|^2E
\]</div>
<h2 id="the-cnlse-class">The <code>CNLSE</code> class</h2>
<p>The <code>CNLSE</code> class is a coupled non-linear Schrödinger equation allowing to solve the following equation:</p>
<div class="arithmatex">\[
\begin{split}
i\frac{\partial\psi_f}{\partial z} &amp;= -\frac{1}{2k_f}\nabla^2\psi_f -\frac{1}{2}n_2^f k_f c\epsilon_0|\psi_f|^2\psi_f + k_f n_2^{fd}c\epsilon_0|\psi_d|^2\psi_f-\frac{i\alpha_f}{2}\psi_f + \frac{\Omega}{2} \psi_d  \\
i\frac{\partial\psi_d}{\partial z} &amp;= -\frac{1}{2k_d}\nabla^2\psi_d -\frac{1}{2}n_2^d k_d c\epsilon_0|\psi_d|^2\psi_d + k_d n_2^{fd}c\epsilon_0|\psi_f|^2\psi_d-\frac{i\alpha_d}{2}\psi_d + \frac{\Omega}{2} \psi_f
\end{split}
\]</div>
<p>This allows to describe the back reaction of the fluid onto the defect as well as two components scenarii.
In order to "turn on" different terms, it suffices to set the parameters value to something other than <code>None</code>.
When <code>None</code>, the solver does not apply the corresponding evolution term for optimal performance.</p>
<h2 id="the-cnlse_1d-class">The <code>CNLSE_1d</code> class</h2>
<p>Similarly to <code>NLSE_1d</code>, the <code>CNLSE_1d</code> is a 1D specialization of <code>CNLSE</code> class.</p>
<p>The propagation equation is:</p>
<div class="arithmatex">\[
\begin{split}
i\frac{\partial\psi_f}{\partial z} &amp;= -\frac{1}{2k_f}\partial^2_x\psi_f -\frac{1}{2}n_2^f k_f c\epsilon_0|\psi_f|^2\psi_f + k_f n_2^{fd}c\epsilon_0|\psi_d|^2\psi_f-\frac{i\alpha_f}{2}\psi_f + \frac{\Omega}{2} \psi_d  \\
i\frac{\partial\psi_d}{\partial z} &amp;= -\frac{1}{2k_d}\partial^2_x\psi_d -\frac{1}{2}n_2^d k_d c\epsilon_0|\psi_d|^2\psi_d + k_d n_2^{fd}c\epsilon_0|\psi_f|^2\psi_d-\frac{i\alpha_d}{2}\psi_d + \frac{\Omega}{2} \psi_f
\end{split}
\]</div>
<h2 id="the-gpe-class">The <code>GPE</code> class</h2>
<p>The <code>GPE</code> class allows to solve the 2D Gross-Pitaevskii equation describing the temporal evolution of a Bosonic field:</p>
<div class="arithmatex">\[
i\partial_{t}\psi = -\frac{1}{2}\nabla^2\psi+V\psi+g|\psi|^2\psi.
\]</div>
<p>It follows exactly the same conventions as the other classes a part from the fact that since it describes atoms, the units are the "atomic" units (masses in kg, times in s).</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.081f42fc.min.js"></script>
      
        <script src="../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>